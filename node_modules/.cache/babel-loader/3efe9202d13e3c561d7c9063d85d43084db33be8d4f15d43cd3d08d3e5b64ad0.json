{"ast":null,"code":"import{useEffect}from\"react\";import{useLocation}from\"react-router-dom\";import{Link}from\"react-router-dom\";import{OrderStats}from\"../../components/order-stats/order-stats\";import{OrderCard}from\"../../components/order-card/order-card\";import styles from\"./feed.module.css\";import{ORDERS_ALL}from\"../../utils/api\";import{useAppDispatch,useAppSelector}from\"../../services/hooks/hooks\";import{connect,wsClose}from\"../../services/store/reducers/socket/actions\";import{allOrdersInf}from\"../../services/store/selector/allOrders/allOrders\";import{ingredientSelector}from\"../../services/store/selector/ingredientSelector\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Feed(){var dispatch=useAppDispatch();var ordersInf=useAppSelector(allOrdersInf);var ordersData=ordersInf&&ordersInf.orders;var ingredientsData=useAppSelector(ingredientSelector);var location=useLocation();function price(item){var totalPrice=0;if(item){item.ingredients.forEach(function(ingrAll){ingredientsData.forEach(function(itemData){if(itemData._id===ingrAll){totalPrice+=itemData.type===\"bun\"?itemData.price*2:itemData.price;}});});}return totalPrice;}useEffect(function(){dispatch(connect(ORDERS_ALL));return function(){wsClose();};},[]);return ordersData&&/*#__PURE__*/_jsxs(\"div\",{className:styles.main,children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text text_type_main-large mb-5 mt-10  \".concat(styles.title),children:\"\\u041B\\u0435\\u043D\\u0442\\u0430 \\u0437\\u0430\\u043A\\u0430\\u0437\\u043E\\u0432\"}),/*#__PURE__*/_jsx(\"section\",{className:\"\".concat(styles.orders,\" custom-scroll pr-2\"),children:ordersData.map(function(item){return/*#__PURE__*/_jsx(Link,{className:styles.link,to:\"\".concat(item.number),state:{background:location},children:/*#__PURE__*/_jsx(OrderCard,{ordersData:item,price:price(item)},item._id)},item._id);})}),/*#__PURE__*/_jsx(\"div\",{className:styles.stats,children:/*#__PURE__*/_jsx(OrderStats,{ordersInf:ordersInf,number:\"\",_id:\"\",status:\"\"})})]});}","map":{"version":3,"names":["useEffect","useLocation","Link","OrderStats","OrderCard","styles","ORDERS_ALL","useAppDispatch","useAppSelector","connect","wsClose","allOrdersInf","ingredientSelector","jsx","_jsx","jsxs","_jsxs","Feed","dispatch","ordersInf","ordersData","orders","ingredientsData","location","price","item","totalPrice","ingredients","forEach","ingrAll","itemData","_id","type","className","main","children","concat","title","map","link","to","number","state","background","stats","status"],"sources":["C:/Users/Nailusha/Desktop/yandex-dev/react-stellar-burger/src/pages/feed/feed.tsx"],"sourcesContent":["import { useEffect } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport { OrderStats } from \"../../components/order-stats/order-stats\";\r\nimport { OrderCard } from \"../../components/order-card/order-card\";\r\nimport { OrderList } from \"../../components/order-icon/order-icon\";\r\n\r\nimport styles from \"./feed.module.css\";\r\nimport { ORDERS_ALL } from \"../../utils/api\";\r\nimport { useAppDispatch, useAppSelector } from \"../../services/hooks/hooks\";\r\nimport { connect, wsClose, wsConnecting, wsMessage } from \"../../services/store/reducers/socket/actions\";\r\nimport { allOrdersInf } from \"../../services/store/selector/allOrders/allOrders\";\r\nimport { ingredientSelector } from \"../../services/store/selector/ingredientSelector\";\r\nimport { FormattedDate } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\n\r\n\r\nimport { TingredintsConstructor, Torder } from \"../../utils/types\";\r\nimport { TFeedOrder } from \"../../utils/live-table\";\r\n\r\nexport default function Feed() {\r\n  const dispatch = useAppDispatch();\r\n  const ordersInf = useAppSelector(allOrdersInf);\r\n  const ordersData = ordersInf && ordersInf.orders;\r\n  const ingredientsData = useAppSelector(ingredientSelector);\r\n  const location = useLocation();\r\n\r\n  function price(item:TFeedOrder) {\r\n    let totalPrice = 0;\r\n    if (item) {\r\n      item.ingredients.forEach((ingrAll) => {\r\n        ingredientsData.forEach(\r\n          (itemData: { _id: string; type: string; price: number }) => {\r\n            if (itemData._id === ingrAll) {\r\n              totalPrice +=\r\n                itemData.type === \"bun\" ? itemData.price * 2 : itemData.price;\r\n            }\r\n          }\r\n        );\r\n      });\r\n    }\r\n    return totalPrice;\r\n  }\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    dispatch(connect(ORDERS_ALL));\r\n\r\n    return () => {\r\n      wsClose();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    ordersData && (\r\n      <div className={styles.main}>\r\n        <h1 className={`text text_type_main-large mb-5 mt-10  ${styles.title}`}>\r\n          Лента заказов\r\n        </h1>\r\n        <section className={`${styles.orders} custom-scroll pr-2`}>\r\n          {ordersData.map((item) => {\r\n            return (\r\n              <Link\r\n                className={styles.link}\r\n                key={item._id}\r\n                to={`${item.number}`}\r\n                state={{ background: location }}\r\n              >\r\n                <OrderCard\r\n                  key={item._id}\r\n                  ordersData={item}\r\n                  price={price(item)}\r\n                />\r\n              </Link>\r\n            );\r\n          })}\r\n        </section>\r\n        <div className={styles.stats}>\r\n          <OrderStats ordersInf={ordersInf} number={\"\"} _id={\"\"} status={\"\"} />\r\n        </div>\r\n      </div>\r\n    )\r\n  );\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}