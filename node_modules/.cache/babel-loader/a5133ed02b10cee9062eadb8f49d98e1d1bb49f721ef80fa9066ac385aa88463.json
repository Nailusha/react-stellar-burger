{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Nailusha\\\\Desktop\\\\yandex-dev\\\\react-stellar-burger\\\\src\\\\components\\\\protected-route\\\\protected-route.jsx\",\n  _s = $RefreshSig$();\nimport { Navigate, useLocation } from \"react-router-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport React, { useEffect } from \"react\";\nimport { setAuthChecked } from \"../../services/store/reducers/userAuthSlice\";\nimport { checkUserAuth } from \"../../utils/api\";\nimport Preloader from \"../preloder/preloder\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Protected = _ref => {\n  _s();\n  let {\n    onlyUnAuth = false,\n    component\n  } = _ref;\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(setAuthChecked(false));\n    dispatch(checkUserAuth());\n  }, [dispatch]);\n  const isAuthChecked = useSelector(store => store.userStatus.isAuthChecked);\n  const user = useSelector(store => store.userStatus.user);\n  const location = useLocation();\n  if (!isAuthChecked) {\n    // Запрос еще выполняется\n    return /*#__PURE__*/_jsxDEV(Preloader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 12\n    }, this); // или прелоадер\n  }\n\n  if (onlyUnAuth && user) {\n    // Пользователь авторизован, но запрос предназначен только для неавторизованных пользователей\n    // Нужно сделать редирект на главную страницу или на тот адрес, что записан в location.state.from\n    const {\n      from\n    } = location.state || {\n      from: {\n        pathname: \"/\"\n      }\n    };\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: from\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 12\n    }, this);\n  }\n  if (!onlyUnAuth && !user) {\n    // Сервер не ответил\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      state: {\n        from: location\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 12\n    }, this);\n  }\n\n  // !onlyUnAuth && user\n  return component;\n};\n_s(Protected, \"qPS6Fxl2DJl8MQz5XmrgbLUjpjM=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useLocation];\n});\n_c = Protected;\nexport const OnlyAuth = props => /*#__PURE__*/_jsxDEV(Protected, {\n  onlyUnAuth: false,\n  ...props\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 41,\n  columnNumber: 36\n}, this);\n_c2 = OnlyAuth;\nexport const OnlyUnAuth = props => /*#__PURE__*/_jsxDEV(Protected, {\n  onlyUnAuth: true,\n  ...props\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 42,\n  columnNumber: 38\n}, this);\n_c3 = OnlyUnAuth;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"Protected\");\n$RefreshReg$(_c2, \"OnlyAuth\");\n$RefreshReg$(_c3, \"OnlyUnAuth\");","map":{"version":3,"names":["Navigate","useLocation","useDispatch","useSelector","React","useEffect","setAuthChecked","checkUserAuth","Preloader","jsxDEV","_jsxDEV","Protected","_ref","_s","onlyUnAuth","component","dispatch","isAuthChecked","store","userStatus","user","location","fileName","_jsxFileName","lineNumber","columnNumber","from","state","pathname","to","_c","OnlyAuth","props","_c2","OnlyUnAuth","_c3","$RefreshReg$"],"sources":["C:/Users/Nailusha/Desktop/yandex-dev/react-stellar-burger/src/components/protected-route/protected-route.jsx"],"sourcesContent":["import { Navigate, useLocation } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport React, { useEffect } from \"react\";\r\nimport { setAuthChecked } from \"../../services/store/reducers/userAuthSlice\";\r\nimport { checkUserAuth } from \"../../utils/api\";\r\nimport Preloader from \"../preloder/preloder\";\r\n\r\nconst Protected = ({ onlyUnAuth = false, component }) => {\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    dispatch(setAuthChecked(false));\r\n    dispatch(checkUserAuth());\r\n  }, [dispatch]);\r\n\r\n  const isAuthChecked = useSelector((store) => store.userStatus.isAuthChecked);\r\n  const user = useSelector((store) => store.userStatus.user);\r\n  const location = useLocation();\r\n\r\n  if (!isAuthChecked) {\r\n    // Запрос еще выполняется\r\n    return <Preloader />; // или прелоадер\r\n  }\r\n\r\n  if (onlyUnAuth && user) {\r\n    // Пользователь авторизован, но запрос предназначен только для неавторизованных пользователей\r\n    // Нужно сделать редирект на главную страницу или на тот адрес, что записан в location.state.from\r\n    const { from } = location.state || { from: { pathname: \"/\" } };\r\n    return <Navigate to={from} />;\r\n  }\r\n\r\n  if (!onlyUnAuth && !user) {\r\n    // Сервер не ответил\r\n    return <Navigate to=\"/login\" state={{ from: location }} />;\r\n  }\r\n\r\n  // !onlyUnAuth && user\r\n  return component;\r\n};\r\n\r\nexport const OnlyAuth = (props) => <Protected onlyUnAuth={false} {...props} />;\r\nexport const OnlyUnAuth = (props) => <Protected onlyUnAuth={true} {...props} />;\r\n"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,WAAW,QAAQ,kBAAkB;AACxD,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,OAAOC,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,cAAc,QAAQ,6CAA6C;AAC5E,SAASC,aAAa,QAAQ,iBAAiB;AAC/C,OAAOC,SAAS,MAAM,sBAAsB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7C,MAAMC,SAAS,GAAGC,IAAA,IAAuC;EAAAC,EAAA;EAAA,IAAtC;IAAEC,UAAU,GAAG,KAAK;IAAEC;EAAU,CAAC,GAAAH,IAAA;EAClD,MAAMI,QAAQ,GAAGd,WAAW,EAAE;EAE9BG,SAAS,CAAC,MAAM;IACdW,QAAQ,CAACV,cAAc,CAAC,KAAK,CAAC,CAAC;IAC/BU,QAAQ,CAACT,aAAa,EAAE,CAAC;EAC3B,CAAC,EAAE,CAACS,QAAQ,CAAC,CAAC;EAEd,MAAMC,aAAa,GAAGd,WAAW,CAAEe,KAAK,IAAKA,KAAK,CAACC,UAAU,CAACF,aAAa,CAAC;EAC5E,MAAMG,IAAI,GAAGjB,WAAW,CAAEe,KAAK,IAAKA,KAAK,CAACC,UAAU,CAACC,IAAI,CAAC;EAC1D,MAAMC,QAAQ,GAAGpB,WAAW,EAAE;EAE9B,IAAI,CAACgB,aAAa,EAAE;IAClB;IACA,oBAAOP,OAAA,CAACF,SAAS;MAAAc,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAG,CAAC,CAAC;EACxB;;EAEA,IAAIX,UAAU,IAAIM,IAAI,EAAE;IACtB;IACA;IACA,MAAM;MAAEM;IAAK,CAAC,GAAGL,QAAQ,CAACM,KAAK,IAAI;MAAED,IAAI,EAAE;QAAEE,QAAQ,EAAE;MAAI;IAAE,CAAC;IAC9D,oBAAOlB,OAAA,CAACV,QAAQ;MAAC6B,EAAE,EAAEH;IAAK;MAAAJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAG;EAC/B;EAEA,IAAI,CAACX,UAAU,IAAI,CAACM,IAAI,EAAE;IACxB;IACA,oBAAOV,OAAA,CAACV,QAAQ;MAAC6B,EAAE,EAAC,QAAQ;MAACF,KAAK,EAAE;QAAED,IAAI,EAAEL;MAAS;IAAE;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAG;EAC5D;;EAEA;EACA,OAAOV,SAAS;AAClB,CAAC;AAACF,EAAA,CA/BIF,SAAS;EAAA,QACIT,WAAW,EAONC,WAAW,EACpBA,WAAW,EACPF,WAAW;AAAA;AAAA6B,EAAA,GAVxBnB,SAAS;AAiCf,OAAO,MAAMoB,QAAQ,GAAIC,KAAK,iBAAKtB,OAAA,CAACC,SAAS;EAACG,UAAU,EAAE,KAAM;EAAA,GAAKkB;AAAK;EAAAV,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,QAAI;AAACQ,GAAA,GAAlEF,QAAQ;AACrB,OAAO,MAAMG,UAAU,GAAIF,KAAK,iBAAKtB,OAAA,CAACC,SAAS;EAACG,UAAU,EAAE,IAAK;EAAA,GAAKkB;AAAK;EAAAV,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,QAAI;AAACU,GAAA,GAAnED,UAAU;AAAA,IAAAJ,EAAA,EAAAG,GAAA,EAAAE,GAAA;AAAAC,YAAA,CAAAN,EAAA;AAAAM,YAAA,CAAAH,GAAA;AAAAG,YAAA,CAAAD,GAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}