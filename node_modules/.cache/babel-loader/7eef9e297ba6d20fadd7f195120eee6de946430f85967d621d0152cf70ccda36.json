{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Nailusha\\\\Desktop\\\\yandex-dev\\\\react-stellar-burger\\\\src\\\\pages\\\\orders\\\\orders.tsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useMemo } from \"react\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport styles from \"./orders.module.css\";\nimport { OrderCard } from \"../../components/order-card/order-card\";\nimport { useAppDispatch, useAppSelector } from \"../../services/hooks/hooks\";\nimport { ingredientSelector } from \"../../services/store/selector/ingredientSelector\";\nimport { allOrdersInf } from \"../../services/store/selector/allOrders/allOrders\";\nimport { connect, wsClose } from \"../../services/store/reducers/socket/actions\";\nimport { ORDERS } from \"../../utils/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function OrdersPage() {\n  _s();\n  const dispatch = useAppDispatch();\n  const ordersInf = useAppSelector(allOrdersInf);\n  const ordersData = ordersInf && ordersInf.orders;\n  const ordersDataReversed = ordersData && [...ordersData].reverse() || [];\n  const location = useLocation();\n  console.log(ordersData);\n  const ingredientsData = useAppSelector(ingredientSelector);\n  const accessToken = useMemo(() => {\n    var _localStorage$getItem;\n    return (_localStorage$getItem = localStorage.getItem(\"accessToken\")) === null || _localStorage$getItem === void 0 ? void 0 : _localStorage$getItem.replace(\"Bearer \", \"\");\n  }, [localStorage.getItem(\"accessToken\")]);\n  function price(item) {\n    let totalPrice = 0;\n    if (item) {\n      item.ingredients.forEach(ingrAll => {\n        ingredientsData.forEach(itemData => {\n          if (itemData._id === ingrAll) {\n            totalPrice += itemData.type === \"bun\" ? itemData.price * 2 : itemData.price;\n          }\n        });\n      });\n    }\n    return totalPrice;\n  }\n  useEffect(() => {\n    dispatch(connect(`${ORDERS}?token=${accessToken}`));\n    return () => {\n      wsClose();\n    };\n  }, []);\n  return ordersDataReversed && /*#__PURE__*/_jsxDEV(\"section\", {\n    className: `${styles.orders} custom-scroll pr-2`,\n    children: ordersDataReversed.map(item => {\n      return /*#__PURE__*/_jsxDEV(Link, {\n        className: styles.link,\n        to: `${item.number}`,\n        state: {\n          background: location\n        },\n        children: /*#__PURE__*/_jsxDEV(OrderCard, {\n          ordersData: item,\n          price: price(item)\n        }, item._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 15\n        }, this)\n      }, item._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 13\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 7\n  }, this);\n}\n_s(OrdersPage, \"2kf7Yo1TecedPZ2C/lO6NP7PPRA=\", false, function () {\n  return [useAppDispatch, useAppSelector, useLocation, useAppSelector];\n});\n_c = OrdersPage;\nvar _c;\n$RefreshReg$(_c, \"OrdersPage\");","map":{"version":3,"names":["useEffect","useMemo","Link","useLocation","styles","OrderCard","useAppDispatch","useAppSelector","ingredientSelector","allOrdersInf","connect","wsClose","ORDERS","jsxDEV","_jsxDEV","OrdersPage","_s","dispatch","ordersInf","ordersData","orders","ordersDataReversed","reverse","location","console","log","ingredientsData","accessToken","_localStorage$getItem","localStorage","getItem","replace","price","item","totalPrice","ingredients","forEach","ingrAll","itemData","_id","type","className","children","map","link","to","number","state","background","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Nailusha/Desktop/yandex-dev/react-stellar-burger/src/pages/orders/orders.tsx"],"sourcesContent":["import { FC, useEffect, useMemo } from \"react\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\nimport styles from \"./orders.module.css\";\r\n\r\nimport { OrderCard } from \"../../components/order-card/order-card\";\r\nimport { useAppDispatch, useAppSelector } from \"../../services/hooks/hooks\";\r\nimport { ingredientSelector } from \"../../services/store/selector/ingredientSelector\";\r\nimport { allOrdersInf } from \"../../services/store/selector/allOrders/allOrders\";\r\nimport { connect, wsClose } from \"../../services/store/reducers/socket/actions\";\r\nimport { ORDERS, ORDERS_ALL } from \"../../utils/api\";\r\nimport { Torder } from \"../../utils/types\";\r\n\r\nexport default function OrdersPage() {\r\n  const dispatch = useAppDispatch();\r\n  const ordersInf = useAppSelector(allOrdersInf);\r\n  const ordersData = ordersInf && ordersInf.orders;\r\n  const ordersDataReversed = (ordersData && [...ordersData].reverse()) || [];\r\n  const location = useLocation();\r\n  console.log(ordersData);\r\n\r\n  const ingredientsData = useAppSelector(ingredientSelector);\r\n\r\n  const accessToken = useMemo(\r\n    () => localStorage.getItem(\"accessToken\")?.replace(\"Bearer \", \"\"),\r\n    [localStorage.getItem(\"accessToken\")]\r\n  );\r\n\r\n  function price(item: Torder) {\r\n    let totalPrice = 0;\r\n    if (item) {\r\n      item.ingredients.forEach((ingrAll) => {\r\n        ingredientsData.forEach((itemData: { _id: string; type: string; price: number; }) => {\r\n          if (itemData._id === ingrAll) {\r\n            totalPrice +=\r\n              itemData.type === \"bun\" ? itemData.price * 2 : itemData.price;\r\n          }\r\n        });\r\n      });\r\n    }\r\n    return totalPrice;\r\n  }\r\n\r\n  useEffect(() => {\r\n    dispatch(connect(`${ORDERS}?token=${accessToken}`));\r\n\r\n    return () => {\r\n      wsClose();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    ordersDataReversed && (\r\n      <section className={`${styles.orders} custom-scroll pr-2`}>\r\n        {ordersDataReversed.map((item: Torder) => {\r\n          return (\r\n            <Link\r\n              className={styles.link}\r\n              key={item._id}\r\n              to={`${item.number}`}\r\n              state={{ background: location }}\r\n            >\r\n              <OrderCard key={item._id} ordersData={item} price={price(item)} />\r\n            </Link>\r\n          );\r\n        })}\r\n      </section>\r\n    )\r\n  );\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}