{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Nailusha\\\\Desktop\\\\yandex-dev\\\\react-stellar-burger\\\\src\\\\components\\\\order-page\\\\order-page.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from \"react\";\nimport styles from \"./order-page.module.css\";\nimport { CurrencyIcon, FormattedDate } from \"@ya.praktikum/react-developer-burger-ui-components\";\nimport { useAppDispatch, useAppSelector } from \"../../services/hooks/hooks\";\nimport { ingredientSelector } from \"../../services/store/selector/ingredientSelector\";\nimport { OrderList } from \"../orderIconList/orderIconList\";\nimport { useParams } from \"react-router-dom\";\nimport { connect, wsClose } from \"../../services/store/reducers/socket/actions\";\nimport { ORDERS_ALL, fetchOrder } from \"../../utils/api\";\nimport { detailsSelector } from \"../../services/store/selector/detailsSelector\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const OrderPage = _ref => {\n  _s();\n  let {\n    modal = false\n  } = _ref;\n  const dispatch = useAppDispatch();\n  const ingredientsData = useAppSelector(ingredientSelector);\n  const {\n    id: number\n  } = useParams();\n  console.log(number);\n  const orderData = useAppSelector(detailsSelector);\n  console.log(orderData);\n  const orderIngredients = orderData && orderData.ingredients;\n  const order = orderData && orderData;\n  function price(item) {\n    let totalPrice = 0;\n    if (item) {\n      item.ingredients.forEach(ingrAll => {\n        ingredientsData.forEach(itemData => {\n          if (itemData._id === ingrAll) {\n            totalPrice += itemData.type === \"bun\" ? itemData.price * 2 : itemData.price;\n          }\n        });\n      });\n    }\n    return totalPrice;\n  }\n  useEffect(() => {\n    dispatch(connect(ORDERS_ALL));\n    dispatch(fetchOrder(number));\n    return () => {\n      wsClose();\n    };\n  }, []);\n  const done = order && order.status === \"done\";\n  return orderData && /*#__PURE__*/_jsxDEV(\"section\", {\n    className: `${styles.container} mt-15 mb-10 mr-10 ml-10`,\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: `text text_type_digits-default ${!modal && styles.number}`,\n      children: `#${order.number}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text text_type_main-medium mt-10\",\n      children: order.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: `text text_type_main-default mt-3 ${done && styles.status}`,\n      children: done ? \"Выполнен\" : \"Готовится\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text text_type_main-medium mt-15 mb-6\",\n      children: \"\\u0421\\u043E\\u0441\\u0442\\u0430\\u0432:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(OrderList, {\n      ingredients: orderIngredients,\n      shift: false\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `${styles.footer} mt-10`,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text text_type_main-default text_color_inactive\",\n        children: /*#__PURE__*/_jsxDEV(FormattedDate, {\n          className: \"text text_type_main-default text_color_inactive\",\n          date: new Date(order.createdAt)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.total,\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text text_type_digits-default mr-2\",\n          children: price(order)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CurrencyIcon, {\n          type: \"primary\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n};\n_s(OrderPage, \"m2e7jLGB8NYaRV41kLYpXj9Q3yg=\", false, function () {\n  return [useAppDispatch, useAppSelector, useParams, useAppSelector];\n});\n_c = OrderPage;\nvar _c;\n$RefreshReg$(_c, \"OrderPage\");","map":{"version":3,"names":["React","useEffect","styles","CurrencyIcon","FormattedDate","useAppDispatch","useAppSelector","ingredientSelector","OrderList","useParams","connect","wsClose","ORDERS_ALL","fetchOrder","detailsSelector","jsxDEV","_jsxDEV","OrderPage","_ref","_s","modal","dispatch","ingredientsData","id","number","console","log","orderData","orderIngredients","ingredients","order","price","item","totalPrice","forEach","ingrAll","itemData","_id","type","done","status","className","container","children","fileName","_jsxFileName","lineNumber","columnNumber","name","shift","footer","date","Date","createdAt","total","_c","$RefreshReg$"],"sources":["C:/Users/Nailusha/Desktop/yandex-dev/react-stellar-burger/src/components/order-page/order-page.tsx"],"sourcesContent":["import React, { FC, useEffect } from \"react\";\r\nimport styles from \"./order-page.module.css\";\r\n\r\nimport {\r\n  CurrencyIcon,\r\n  FormattedDate,\r\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { useAppDispatch, useAppSelector } from \"../../services/hooks/hooks\";\r\nimport { ingredientSelector } from \"../../services/store/selector/ingredientSelector\";\r\nimport { OrderList } from \"../orderIconList/orderIconList\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { allOrdersInf } from \"../../services/store/selector/wsSelectors/allOrders\";\r\nimport { connect, wsClose } from \"../../services/store/reducers/socket/actions\";\r\nimport { ORDERS_ALL, fetchOrder } from \"../../utils/api\";\r\nimport { TingredientType } from \"../../utils/types\";\r\nimport { detailsSelector } from \"../../services/store/selector/detailsSelector\";\r\nimport { TFeedOrder } from \"../../utils/live-table\";\r\n\r\nexport const OrderPage = ({ modal = false }) => {\r\n  const dispatch = useAppDispatch();\r\n  const ingredientsData = useAppSelector(ingredientSelector);\r\n  const { id: number } = useParams();\r\n  console.log(number)\r\n  const orderData = useAppSelector(detailsSelector)\r\n  console.log(orderData)\r\n  const orderIngredients = orderData&&orderData.ingredients;\r\n  const order = orderData && orderData;\r\n\r\n  function price(item: TFeedOrder) {\r\n    let totalPrice = 0;\r\n    if (item) {\r\n      item.ingredients.forEach((ingrAll) => {\r\n        ingredientsData.forEach((itemData: { _id: string; type: string; price: number; }) => {\r\n          if (itemData._id === ingrAll) {\r\n            totalPrice +=\r\n              itemData.type === \"bun\" ? itemData.price * 2 : itemData.price;\r\n          }\r\n        });\r\n      });\r\n    }\r\n    return totalPrice;\r\n  }\r\n\r\n   \r\n\r\n  useEffect(() => {\r\n    dispatch(connect(ORDERS_ALL));\r\n    dispatch(fetchOrder(number));   \r\n\r\n    return () => {\r\n      wsClose();\r\n    };\r\n  }, []);\r\n\r\n  const done = order && order.status === \"done\";\r\n  \r\n\r\n  return (\r\n    orderData &&\r\n    <section className={`${styles.container} mt-15 mb-10 mr-10 ml-10`}>\r\n      <p\r\n        className={`text text_type_digits-default ${!modal && styles.number}`}\r\n      >{`#${order.number}`}</p>\r\n      <p className={\"text text_type_main-medium mt-10\"}>{order.name}</p>\r\n      <p\r\n        className={`text text_type_main-default mt-3 ${done && styles.status}`}\r\n      >\r\n        {done ? \"Выполнен\" : \"Готовится\"}\r\n      </p>\r\n      <p className={\"text text_type_main-medium mt-15 mb-6\"}>Состав:</p>\r\n      <OrderList\r\n        ingredients={orderIngredients}\r\n        shift={false}\r\n      />\r\n      <div className={`${styles.footer} mt-10`}>\r\n        <p className={\"text text_type_main-default text_color_inactive\"}>\r\n          <FormattedDate\r\n            className={\"text text_type_main-default text_color_inactive\"}\r\n            date={new Date(order.createdAt)}\r\n          />\r\n        </p>\r\n        <div className={styles.total}>\r\n          <p className={\"text text_type_digits-default mr-2\"}>{price(order)}</p>\r\n          <CurrencyIcon type=\"primary\" />\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}